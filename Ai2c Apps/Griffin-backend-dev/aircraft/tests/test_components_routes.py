import math
from io import StringIO
from typing import List

from defusedcsv import csv
from django.test import TestCase, tag
from ninja.testing import TestClient

from aircraft.api.components.routes import component_router
from aircraft.models import ShortLife, SurvivalPredictions
from utils.tests import (
    create_single_test_aircraft,
    create_single_test_short_life,
    create_single_test_surv_pred,
    create_test_units,
    create_test_user,
)
from utils.tests.test_aircraft_creation import create_test_aircraft_in_all
from utils.tests.test_airframe_creation import create_single_test_airframe


@tag("aircraft")
class ShortLifeTest(TestCase):
    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0])
        # create short life object
        self.short_life = create_single_test_short_life(aircraft=self.aircraft)
        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})
        self.unauthorized_client = TestClient(component_router, headers={"Auth-User": "FAKE_USER"})

    def test_list_short_life_valid_uic(self):
        response = self.client.get(f"/short-life?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 200)
        # Should return 1 short life object
        self.assertEqual(response.data["count"], 1)
        self.assertEqual(response.data["items"][0]["work_unit_code"], self.short_life.work_unit_code)

    def test_list_short_life_invalid_uic(self):
        response = self.client.get("/short-life?uic=FAKEUIC")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data["count"], 0)  # No short life for Fake Unit

    def test_list_short_life_unauthorized_user(self):
        response = self.unauthorized_client.get(f"/short-life?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 401)

    def test_list_full_short_life(self):
        response = self.client.get(f"/full-short-life?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["work_unit_code"], self.short_life.work_unit_code)

    def test_parts_list(self):
        create_single_test_short_life(aircraft=self.aircraft, part_number="7890123")
        # Add second duplicate part to ensure unique part numbers returned.
        create_single_test_short_life(aircraft=self.aircraft, part_number="7890123")
        create_single_test_short_life(
            aircraft=create_single_test_aircraft(self.units_created[0], serial="TESTAIR", model="UH-33A", mds="UH-33A"),
            part_number="7890123",
        )
        response = self.client.get(f"/part-list?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(
            response.data,
            [
                {"part_number": "123456", "models": ["TH-10A"]},
                {"part_number": "7890123", "models": ["TH-10A", "UH-33A"]},
            ],
        )


@tag("aircraft")
class SurvivalPredictionsTest(TestCase):
    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0])
        # create survival prediction object
        self.survival_prediction = create_single_test_surv_pred(aircraft=self.aircraft)
        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})
        self.unauthorized_client = TestClient(component_router, headers={"Auth-User": "FAKE_USER"})

    def test_list_surv_pred_valid_aircraft(self):
        response = self.client.get(f"/surv-preds?aircraft_serial={self.aircraft.serial}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["work_unit_code"], "TESTWUC")

    def test_list_surv_pred_invalid_aircraft(self):
        response = self.client.get("/surv-preds?aircraft_serial=FAKEAIRCRAFT")
        self.assertEqual(response.status_code, 404)

    def test_list_surv_pred_unauthorized_user(self):
        response = self.unauthorized_client.get(f"/surv-preds?aircraft_serial={self.aircraft.serial}")
        self.assertEqual(response.status_code, 401)


@tag("aircraft")
class FailurePredictionsTest(TestCase):
    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0])
        # create survival prediction object (used to calculate failure predictions)
        self.survival_prediction = create_single_test_surv_pred(aircraft=self.aircraft)
        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})
        self.unauthorized_client = TestClient(component_router, headers={"Auth-User": "FAKE_USER"})

    def test_list_failure_pred_valid_aircraft(self):
        response = self.client.get(f"/failure-preds?horizon=5&aircraft={self.aircraft.serial}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["most_likely"], self.aircraft.serial)

    def test_list_failure_pred_invalid_aircraft(self):
        response = self.client.get("/failure-preds?horizon=5&aircraft=FAKEAIRCRAFT")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 0)

    def test_list_failure_pred_unauthorized_user(self):
        response = self.unauthorized_client.get(f"/failure-preds?horizon=5&aircraft={self.aircraft.serial}")
        self.assertEqual(response.status_code, 401)


@tag("aircraft")
class ComponentRiskTests(TestCase):
    def _calc_probs(self, horizon: List[float], std_err: List[float]):
        survival = 1
        rel_err = 0
        for horz, stderr in zip(horizon, std_err):
            survival = survival * horz
            rel_err = rel_err + ((stderr / horz) ** 2)

        new_err = survival * math.sqrt(rel_err)
        upper = float(1 - survival - 1.96 * new_err)
        lower = float(1 - survival + 1.96 * new_err)

        return (float(1 - survival), upper, lower)

    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0])
        self.aircraft2 = create_single_test_aircraft(
            self.units_created[1], model="TH-10B", mds="TH-10BX", serial="TESTAIRCRAFT2"
        )
        # create survival prediction object (used to calculate failure predictions)
        self.horz1 = 0.993736978690398
        self.std_err1 = 0.000156575532740039
        self.horz2 = 0.983736978690398
        self.std_err2 = 0.000126575532740039

        self.prob1, self.upper1, self.lower1 = self._calc_probs([self.horz1], [self.std_err1])
        self.prob2, self.upper2, self.lower2 = self._calc_probs([self.horz2], [self.std_err2])
        self.survival_prediction = create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
            part_number="ABC123",
        )
        self.survival_prediction2 = create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="CDE456",
        )

        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})
        self.unauthorized_client = TestClient(component_router, headers={"Auth-User": "FAKE_USER"})

    def test_component_risk__unit(self):
        response = self.client.get(f"/component-risk?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["part_number"], self.survival_prediction2.part_number)
        self.assertEqual(response.data[0]["nomenclature"], self.survival_prediction2.nomenclature)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower2)
        self.assertEqual(response.data[1]["part_number"], self.survival_prediction.part_number)
        self.assertEqual(response.data[1]["nomenclature"], self.survival_prediction.nomenclature)
        self.assertEqual(response.data[1]["failure_detail"]["failure_prob_5"], self.prob1)
        self.assertEqual(response.data[1]["failure_detail"]["failure_upper_5"], self.upper1)
        self.assertEqual(response.data[1]["failure_detail"]["failure_lower_5"], self.lower1)

    def test_component_risk__other_unit(self):
        response = self.client.get(
            f"/component-risk?uic={self.units_created[0].uic}&other_uics={self.units_created[1].uic}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["part_number"], self.survival_prediction2.part_number)
        self.assertEqual(response.data[0]["nomenclature"], self.survival_prediction2.nomenclature)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower2)
        self.assertEqual(len(response.data), 1)

    def test_component_risk__aircraft(self):
        response = self.client.get(
            f"/component-risk?uic={self.units_created[0].uic}&serial_numbers={self.aircraft.serial}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["part_number"], self.survival_prediction.part_number)
        self.assertEqual(response.data[0]["nomenclature"], self.survival_prediction.nomenclature)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower1)

    def test_component_risk__part_number(self):
        response = self.client.get(
            f"/component-risk?uic={self.units_created[0].uic}&part_numbers={self.survival_prediction.part_number}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["part_number"], self.survival_prediction.part_number)
        self.assertEqual(response.data[0]["nomenclature"], self.survival_prediction.nomenclature)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower1)

    def test_component_risk__uic_bottom(self):
        self.unit_aircraft = create_test_aircraft_in_all([self.units_created[0]], num_of_aircraft=20)
        tmp_horz = self.horz2
        tmp_err = self.std_err2
        aircraft_counter = 0
        for aircraft in self.unit_aircraft:
            create_single_test_surv_pred(
                aircraft=aircraft,
                horizon_100=tmp_horz,
                std_err_100=tmp_err,
                horizon_5=tmp_horz,
                std_err_5=tmp_err,
                part_number=f"ABC{str(aircraft_counter)}",
            )
            aircraft_counter += 1
        response = self.client.get(f"/component-risk?uic={self.units_created[0].uic}&variant=bottom")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 10)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[2]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[3]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[4]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[5]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[6]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[7]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[8]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[9]["failure_detail"]["failure_prob_5"], self.prob1)


@tag("aircraft")
class RiskTests(TestCase):
    def _calc_probs(self, horizon: List[float], std_err: List[float]):
        survival = 1
        rel_err = 0
        for horz, stderr in zip(horizon, std_err):
            survival = survival * horz
            rel_err = rel_err + ((stderr / horz) ** 2)

        new_err = survival * math.sqrt(rel_err)
        upper = float(1 - survival - 1.96 * new_err)
        lower = float(1 - survival + 1.96 * new_err)

        return (float(1 - survival), upper, lower)

    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0])
        self.aircraft2 = create_single_test_aircraft(
            self.units_created[0], model="TH-10B", mds="TH-10BX", serial="TESTAIRCRAFT2"
        )
        # create survival prediction object (used to calculate failure predictions)
        self.horz1 = 0.993736978690398
        self.std_err1 = 0.000156575532740039
        self.horz2 = 0.983736978690398
        self.std_err2 = 0.000126575532740039

        self.prob1, self.upper1, self.lower1 = self._calc_probs([self.horz1], [self.std_err1])
        self.prob2, self.upper2, self.lower2 = self._calc_probs([self.horz2], [self.std_err2])
        self.survival_prediction = create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
            part_number="ABC123",
        )
        self.survival_prediction2 = create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="ABC123",
        )

        self.unit_aircraft = create_test_aircraft_in_all(self.units_created, num_of_aircraft=20)
        tmp_horz = self.horz1
        tmp_err = self.std_err1
        for aircraft in self.unit_aircraft:
            tmp_horz = tmp_horz - 0.01
            tmp_err = tmp_err + 0.01
            create_single_test_surv_pred(
                aircraft=aircraft, horizon_100=tmp_horz, std_err_100=tmp_err, horizon_5=tmp_horz, std_err_5=tmp_err
            )

        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})
        self.unauthorized_client = TestClient(component_router, headers={"Auth-User": "FAKE_USER"})

    def test_model_risk_multiple_aircraft(self):
        response = self.client.get(f"/model-risk?uic={self.units_created[0].uic}&part_number=ABC123")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["model_name"], self.aircraft.model)
        # 0.0062630213096019904
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob1)
        # 0.005956133265431514
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper1)
        # 0.006569909353772467
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower1)
        self.assertEqual(response.data[1]["model_name"], self.aircraft2.model)
        self.assertEqual(response.data[1]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_upper_5"], self.upper2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_lower_5"], self.lower2)

    def test_model_risk_multiple_parts(self):
        create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
            part_number="ABC123",
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
            part_number="ABC123",
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="ABC123",
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="ABC123",
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="ABC123",
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
            part_number="ABC123",
        )
        prob1, upper1, lower1 = self._calc_probs(
            [self.horz1, self.horz1, self.horz1], [self.std_err1, self.std_err1, self.std_err1]
        )
        prob2, upper2, lower2 = self._calc_probs(
            [self.horz2, self.horz2, self.horz2, self.horz2, self.horz2],
            [self.std_err2, self.std_err2, self.std_err2, self.std_err2, self.std_err2],
        )
        response = self.client.get(f"/model-risk?uic={self.units_created[0].uic}&part_number=ABC123")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["model_name"], self.aircraft.model)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], prob1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], upper1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], lower1)
        self.assertEqual(response.data[1]["model_name"], self.aircraft2.model)
        self.assertEqual(response.data[1]["failure_detail"]["failure_prob_5"], prob2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_upper_5"], upper2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_lower_5"], lower2)

    def test_model_risk_no_parts(self):
        response = self.client.get(f"/model-risk?uic={self.units_created[0].uic}&part_number=ABCXYZ")
        self.assertEqual(response.data, [])

    def test_aircraft_risk_multiple_aircraft(self):
        response = self.client.get(f"/aircraft-risk?uic={self.units_created[0].uic}&serial_numbers=TESTAIRCRAFT")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["serial_number"], self.aircraft.serial)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower1)

    def test_aircraft_risk_uic_single_part_number(self):
        response = self.client.get(
            f"/aircraft-risk?uic={self.units_created[0].uic}&part_numbers={self.survival_prediction.part_number}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["serial_number"], self.aircraft2.serial)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], self.prob2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], self.upper2)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], self.lower2)

    def test_aircraft_risk_multiple_parts(self):
        create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft,
            horizon_5=self.horz1,
            std_err_5=self.std_err1,
            horizon_100=self.horz1,
            std_err_100=self.std_err1,
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
        )
        create_single_test_surv_pred(
            aircraft=self.aircraft2,
            horizon_5=self.horz2,
            std_err_5=self.std_err2,
            horizon_100=self.horz2,
            std_err_100=self.std_err2,
        )
        prob1, upper1, lower1 = self._calc_probs(
            [self.horz1, self.horz1, self.horz1], [self.std_err1, self.std_err1, self.std_err1]
        )
        prob2, upper2, lower2 = self._calc_probs(
            [self.horz2, self.horz2, self.horz2, self.horz2, self.horz2],
            [self.std_err2, self.std_err2, self.std_err2, self.std_err2, self.std_err2],
        )
        response = self.client.get(
            f"/aircraft-risk?uic={self.units_created[0].uic}&serial_numbers=TESTAIRCRAFT&serial_numbers=TESTAIRCRAFT2"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data[0]["serial_number"], self.aircraft.serial)
        self.assertEqual(response.data[0]["failure_detail"]["failure_prob_5"], prob1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_upper_5"], upper1)
        self.assertEqual(response.data[0]["failure_detail"]["failure_lower_5"], lower1)
        self.assertEqual(response.data[1]["serial_number"], self.aircraft2.serial)
        self.assertEqual(response.data[1]["failure_detail"]["failure_prob_5"], prob2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_upper_5"], upper2)
        self.assertEqual(response.data[1]["failure_detail"]["failure_lower_5"], lower2)

    def test_aircraft_risk_highest(self):
        expected = [
            {
                "serial_number": "TEST000C0AIRCRAFT81",
                "failure_detail": {
                    "failure_prob_5": 0.8062630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.8062630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT80",
                "failure_detail": {
                    "failure_prob_5": 0.7962630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7962630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT79",
                "failure_detail": {
                    "failure_prob_5": 0.7862630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7862630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT78",
                "failure_detail": {
                    "failure_prob_5": 0.7762630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7762630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT77",
                "failure_detail": {
                    "failure_prob_5": 0.7662630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7662630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT76",
                "failure_detail": {
                    "failure_prob_5": 0.7562630213096027,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7562630213096027,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT75",
                "failure_detail": {
                    "failure_prob_5": 0.7462630213096026,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7462630213096026,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT74",
                "failure_detail": {
                    "failure_prob_5": 0.7362630213096026,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7362630213096026,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT73",
                "failure_detail": {
                    "failure_prob_5": 0.7262630213096026,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7262630213096026,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000C0AIRCRAFT72",
                "failure_detail": {
                    "failure_prob_5": 0.7162630213096026,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.7162630213096026,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
        ]
        response = self.client.get(f"/aircraft-risk?uic={self.units_created[0].uic}")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 10)
        self.assertEqual(response.data, expected)

    def test_aircraft_risk_lowest(self):
        expected = [
            {
                "serial_number": "TEST000AAAIRCRAFT9",
                "failure_detail": {
                    "failure_prob_5": 0.08626302130960206,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.24336990935377253,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.08626302130960206,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.24336990935377253,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT8",
                "failure_detail": {
                    "failure_prob_5": 0.07626302130960205,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.21376990935377255,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.07626302130960205,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.21376990935377255,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT7",
                "failure_detail": {
                    "failure_prob_5": 0.06626302130960204,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.18416990935377253,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.06626302130960204,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.18416990935377253,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT6",
                "failure_detail": {
                    "failure_prob_5": 0.056263021309602035,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.15456990935377252,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.056263021309602035,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.15456990935377252,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT5",
                "failure_detail": {
                    "failure_prob_5": 0.046263021309602026,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.1249699093537725,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.046263021309602026,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.1249699093537725,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT4",
                "failure_detail": {
                    "failure_prob_5": 0.03626302130960202,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.09536990935377249,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.03626302130960202,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.09536990935377249,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT3",
                "failure_detail": {
                    "failure_prob_5": 0.026263021309602008,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.06576990935377248,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.026263021309602008,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.06576990935377248,
                },
            },
            {
                "serial_number": "TESTAIRCRAFT2",
                "failure_detail": {
                    "failure_prob_5": 0.016263021309602,
                    "failure_upper_5": 0.016014933265431523,
                    "failure_lower_5": 0.016511109353772476,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.016263021309602,
                    "failure_upper_100": 0.016014933265431523,
                    "failure_lower_100": 0.016511109353772476,
                },
            },
            {
                "serial_number": "TEST000AAAIRCRAFT2",
                "failure_detail": {
                    "failure_prob_5": 0.016263021309602,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 0.03616990935377248,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.016263021309602,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 0.03616990935377248,
                },
            },
            {
                "serial_number": "TESTAIRCRAFT",
                "failure_detail": {
                    "failure_prob_5": 0.0062630213096019904,
                    "failure_upper_5": 0.005956133265431514,
                    "failure_lower_5": 0.006569909353772467,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.0062630213096019904,
                    "failure_upper_100": 0.005956133265431514,
                    "failure_lower_100": 0.006569909353772467,
                },
            },
        ]
        response = self.client.get(f"/aircraft-risk?uic={self.units_created[0].uic}&variant=bottom")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 10)
        self.assertEqual(response.data, expected)

    def test_aircraft_risk_other_uics(self):
        expected = [
            {
                "serial_number": "TEST000B0AIRCRAFT61",
                "failure_detail": {
                    "failure_prob_5": 0.6062630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.6062630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT60",
                "failure_detail": {
                    "failure_prob_5": 0.5962630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5962630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT59",
                "failure_detail": {
                    "failure_prob_5": 0.5862630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5862630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT58",
                "failure_detail": {
                    "failure_prob_5": 0.5762630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5762630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT57",
                "failure_detail": {
                    "failure_prob_5": 0.5662630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5662630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT56",
                "failure_detail": {
                    "failure_prob_5": 0.5562630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5562630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT55",
                "failure_detail": {
                    "failure_prob_5": 0.5462630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5462630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT54",
                "failure_detail": {
                    "failure_prob_5": 0.5362630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5362630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT53",
                "failure_detail": {
                    "failure_prob_5": 0.5262630213096025,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5262630213096025,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
            {
                "serial_number": "TEST000B0AIRCRAFT52",
                "failure_detail": {
                    "failure_prob_5": 0.5162630213096024,
                    "failure_upper_5": 0.0,
                    "failure_lower_5": 1.0,
                    "failure_prob_10": 0.010000000000000009,
                    "failure_upper_10": 0.0,
                    "failure_lower_10": 1.0,
                    "failure_prob_15": 0.010000000000000009,
                    "failure_upper_15": 0.0,
                    "failure_lower_15": 1.0,
                    "failure_prob_20": 0.010000000000000009,
                    "failure_upper_20": 0.0,
                    "failure_lower_20": 1.0,
                    "failure_prob_25": 0.010000000000000009,
                    "failure_upper_25": 0.0,
                    "failure_lower_25": 1.0,
                    "failure_prob_30": 0.010000000000000009,
                    "failure_upper_30": 0.0,
                    "failure_lower_30": 1.0,
                    "failure_prob_35": 0.010000000000000009,
                    "failure_upper_35": 0.0,
                    "failure_lower_35": 1.0,
                    "failure_prob_40": 0.010000000000000009,
                    "failure_upper_40": 0.0,
                    "failure_lower_40": 1.0,
                    "failure_prob_45": 0.010000000000000009,
                    "failure_upper_45": 0.0,
                    "failure_lower_45": 1.0,
                    "failure_prob_50": 0.010000000000000009,
                    "failure_upper_50": 0.0,
                    "failure_lower_50": 1.0,
                    "failure_prob_55": 0.010000000000000009,
                    "failure_upper_55": 0.0,
                    "failure_lower_55": 1.0,
                    "failure_prob_60": 0.010000000000000009,
                    "failure_upper_60": 0.0,
                    "failure_lower_60": 1.0,
                    "failure_prob_65": 0.010000000000000009,
                    "failure_upper_65": 0.0,
                    "failure_lower_65": 1.0,
                    "failure_prob_70": 0.010000000000000009,
                    "failure_upper_70": 0.0,
                    "failure_lower_70": 1.0,
                    "failure_prob_75": 0.010000000000000009,
                    "failure_upper_75": 0.0,
                    "failure_lower_75": 1.0,
                    "failure_prob_80": 0.010000000000000009,
                    "failure_upper_80": 0.0,
                    "failure_lower_80": 1.0,
                    "failure_prob_85": 0.010000000000000009,
                    "failure_upper_85": 0.0,
                    "failure_lower_85": 1.0,
                    "failure_prob_90": 0.010000000000000009,
                    "failure_upper_90": 0.0,
                    "failure_lower_90": 1.0,
                    "failure_prob_95": 0.010000000000000009,
                    "failure_upper_95": 0.0,
                    "failure_lower_95": 1.0,
                    "failure_prob_100": 0.5162630213096024,
                    "failure_upper_100": 0.0,
                    "failure_lower_100": 1.0,
                },
            },
        ]
        url = "/aircraft-risk?uic={}&other_uics={}&other_uics={}&variant=top".format(
            self.units_created[0].uic, self.units_created[1].uic, self.units_created[2].uic
        )
        response = self.client.get(url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 10)
        self.assertEqual(response.data, expected)

    def test_failure_count_valid(self):
        expected = [
            {
                "part_number": "ABC123",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10B",
                "serial": "TESTAIRCRAFT2",
                "failure_chance": 0.016263021309602,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT2",
                "failure_chance": 0.016263021309602,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT3",
                "failure_chance": 0.026263021309602008,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT4",
                "failure_chance": 0.03626302130960202,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT5",
                "failure_chance": 0.046263021309602026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT6",
                "failure_chance": 0.056263021309602035,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT7",
                "failure_chance": 0.06626302130960204,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT8",
                "failure_chance": 0.07626302130960205,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT9",
                "failure_chance": 0.08626302130960206,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT10",
                "failure_chance": 0.09626302130960207,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT11",
                "failure_chance": 0.10626302130960208,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT12",
                "failure_chance": 0.11626302130960209,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT13",
                "failure_chance": 0.1262630213096021,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT14",
                "failure_chance": 0.1362630213096021,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT15",
                "failure_chance": 0.14626302130960211,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT16",
                "failure_chance": 0.15626302130960212,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT17",
                "failure_chance": 0.16626302130960213,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT18",
                "failure_chance": 0.17626302130960214,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT19",
                "failure_chance": 0.18626302130960215,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT20",
                "failure_chance": 0.19626302130960216,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000AAAIRCRAFT21",
                "failure_chance": 0.20626302130960217,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT22",
                "failure_chance": 0.21626302130960218,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT23",
                "failure_chance": 0.22626302130960219,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT24",
                "failure_chance": 0.2362630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT25",
                "failure_chance": 0.2462630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT26",
                "failure_chance": 0.2562630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT27",
                "failure_chance": 0.2662630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT28",
                "failure_chance": 0.27626302130960223,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT29",
                "failure_chance": 0.28626302130960224,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT30",
                "failure_chance": 0.29626302130960225,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT31",
                "failure_chance": 0.30626302130960226,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT32",
                "failure_chance": 0.31626302130960227,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT33",
                "failure_chance": 0.3262630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT34",
                "failure_chance": 0.3362630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT35",
                "failure_chance": 0.3462630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT36",
                "failure_chance": 0.3562630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT37",
                "failure_chance": 0.3662630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT38",
                "failure_chance": 0.3762630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT39",
                "failure_chance": 0.38626302130960233,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT40",
                "failure_chance": 0.39626302130960234,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT41",
                "failure_chance": 0.40626302130960235,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT42",
                "failure_chance": 0.41626302130960235,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT43",
                "failure_chance": 0.42626302130960236,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT44",
                "failure_chance": 0.4362630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT45",
                "failure_chance": 0.4462630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT46",
                "failure_chance": 0.4562630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT47",
                "failure_chance": 0.4662630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT48",
                "failure_chance": 0.4762630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT49",
                "failure_chance": 0.4862630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT50",
                "failure_chance": 0.4962630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT51",
                "failure_chance": 0.5062630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT52",
                "failure_chance": 0.5162630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT53",
                "failure_chance": 0.5262630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT54",
                "failure_chance": 0.5362630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT55",
                "failure_chance": 0.5462630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT56",
                "failure_chance": 0.5562630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT57",
                "failure_chance": 0.5662630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT58",
                "failure_chance": 0.5762630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT59",
                "failure_chance": 0.5862630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT60",
                "failure_chance": 0.5962630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT61",
                "failure_chance": 0.6062630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT62",
                "failure_chance": 0.6162630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT63",
                "failure_chance": 0.6262630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT64",
                "failure_chance": 0.6362630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT65",
                "failure_chance": 0.6462630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT66",
                "failure_chance": 0.6562630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT67",
                "failure_chance": 0.6662630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT68",
                "failure_chance": 0.6762630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT69",
                "failure_chance": 0.6862630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT70",
                "failure_chance": 0.6962630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT71",
                "failure_chance": 0.7062630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT72",
                "failure_chance": 0.7162630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT73",
                "failure_chance": 0.7262630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT74",
                "failure_chance": 0.7362630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT75",
                "failure_chance": 0.7462630213096026,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT76",
                "failure_chance": 0.7562630213096027,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT77",
                "failure_chance": 0.7662630213096027,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT78",
                "failure_chance": 0.7762630213096027,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT79",
                "failure_chance": 0.7862630213096027,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT80",
                "failure_chance": 0.7962630213096027,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000C0AIRCRAFT81",
                "failure_chance": 0.8062630213096027,
                "work_unit_code": "TESTWUC",
            },
        ]
        response = self.client.get(f"/failure-count?uic={self.units_created[0].uic}&hour=5&failure_percentage=0.01")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data, expected)

    def test_failure_count_empty(self):
        response = self.client.get(f"/failure-count?uic={self.units_created[0].uic}&hour=5&failure_percentage=0.9")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data, [])

    def test_failure_count_invalid_hour(self):
        response = self.client.get(f"/failure-count?uic={self.units_created[0].uic}&hour=3&failure_percentage=0.9")
        self.assertEqual(response.status_code, 400)
        self.assertEqual(response.data["message"], "Invalid hour.  Hour must be divisible by 5 and between 5 and 100")

    def test_failure_count_invalid_percentage(self):
        response = self.client.get(f"/failure-count?uic={self.units_created[0].uic}&hour=10&failure_percentage=2")
        self.assertEqual(response.status_code, 400)
        self.assertEqual(response.data["message"], "Invalid percentage.  Failure percentage must be between 0 and 1")

    def test_failure_count_other_uics(self):
        expected = [
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT22",
                "failure_chance": 0.21626302130960218,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT23",
                "failure_chance": 0.22626302130960219,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT24",
                "failure_chance": 0.2362630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT25",
                "failure_chance": 0.2462630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT26",
                "failure_chance": 0.2562630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT27",
                "failure_chance": 0.2662630213096022,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT28",
                "failure_chance": 0.27626302130960223,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT29",
                "failure_chance": 0.28626302130960224,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT30",
                "failure_chance": 0.29626302130960225,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT31",
                "failure_chance": 0.30626302130960226,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT32",
                "failure_chance": 0.31626302130960227,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT33",
                "failure_chance": 0.3262630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT34",
                "failure_chance": 0.3362630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT35",
                "failure_chance": 0.3462630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT36",
                "failure_chance": 0.3562630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT37",
                "failure_chance": 0.3662630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT38",
                "failure_chance": 0.3762630213096023,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT39",
                "failure_chance": 0.38626302130960233,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT40",
                "failure_chance": 0.39626302130960234,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000A0AIRCRAFT41",
                "failure_chance": 0.40626302130960235,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT42",
                "failure_chance": 0.41626302130960235,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT43",
                "failure_chance": 0.42626302130960236,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT44",
                "failure_chance": 0.4362630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT45",
                "failure_chance": 0.4462630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT46",
                "failure_chance": 0.4562630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT47",
                "failure_chance": 0.4662630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT48",
                "failure_chance": 0.4762630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT49",
                "failure_chance": 0.4862630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT50",
                "failure_chance": 0.4962630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT51",
                "failure_chance": 0.5062630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT52",
                "failure_chance": 0.5162630213096024,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT53",
                "failure_chance": 0.5262630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT54",
                "failure_chance": 0.5362630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT55",
                "failure_chance": 0.5462630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT56",
                "failure_chance": 0.5562630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT57",
                "failure_chance": 0.5662630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT58",
                "failure_chance": 0.5762630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT59",
                "failure_chance": 0.5862630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT60",
                "failure_chance": 0.5962630213096025,
                "work_unit_code": "TESTWUC",
            },
            {
                "part_number": "123456",
                "nomenclature": "TEST Nomenclature",
                "model": "TH-10A",
                "serial": "TEST000B0AIRCRAFT61",
                "failure_chance": 0.6062630213096025,
                "work_unit_code": "TESTWUC",
            },
        ]
        url = "/failure-count?uic={}&other_uics={}&other_uics={}&hour=5&failure_percentage=0.01".format(
            self.units_created[0].uic, self.units_created[1].uic, self.units_created[2].uic
        )
        response = self.client.get(url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.data, expected)


@tag("aircraft")
class ComponentChecklistExportTest(TestCase):
    def setUp(self):
        # create unit to house test aircraft
        self.units_created, self.uic_hierarchy = create_test_units(
            uic_stub="TEST000",
            echelon="BN",
            short_name="100th TEST",
            display_name="100th Test Aviation Regiment",
        )

        # Create User for authentication
        self.user = create_test_user(unit=self.units_created[0])
        # Create an Airframe
        self.airframe = create_single_test_airframe()
        # Create Aircraft in Unit
        self.aircraft = create_single_test_aircraft(self.units_created[0], airframe=self.airframe)
        # create short life object
        self.short_life = create_single_test_short_life(aircraft=self.aircraft)
        # create survival prediction object
        self.survival_prediction = create_single_test_surv_pred(aircraft=self.aircraft)
        self.client = TestClient(component_router, headers={"Auth-User": self.user.user_id})

    def test_comp_checklist_export(self):
        response = self.client.get(
            f"/comp-checklist-export?uic={self.units_created[0].uic}&hour=5&aircraft_serials={self.aircraft.serial}&aircraft_models={self.airframe.model}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response["Content-Type"], "text/csv")
        self.assertTrue("attachment; filename=" in response["Content-Disposition"])

        # Read the CSV content
        csv_content = response.content.decode("utf-8")
        csv_reader = csv.reader(StringIO(csv_content))
        rows = list(csv_reader)

        # Check the header
        expected_header = ["Aircraft serial", "Part number", "Description", "Failure 5 hours"]
        self.assertEqual(rows[0], expected_header)

        # Ensure there is at least one data row
        self.assertGreater(len(rows), 1, "No data rows found in the CSV content")

        # Check the data row
        expected_row = [
            self.aircraft.serial,
            self.short_life.part_number,
            self.short_life.nomenclature,
            f"{int((1 - self.survival_prediction.horizon_5) * 100)}%",
        ]
        self.assertEqual(rows[1], expected_row)

    def test_comp_checklist_export_no_data(self):
        # Clear the data
        ShortLife.objects.all().delete()
        SurvivalPredictions.objects.all().delete()

        response = self.client.get(
            f"/comp-checklist-export?uic={self.units_created[0].uic}&hour=5&aircraft_serials={self.aircraft.serial}&aircraft_models={self.airframe.model}"
        )
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response["Content-Type"], "text/csv")
        self.assertTrue("attachment; filename=" in response["Content-Disposition"])

        # Read the CSV content
        csv_content = response.content.decode("utf-8")
        csv_reader = csv.reader(StringIO(csv_content))
        rows = list(csv_reader)

        # Check the header
        expected_header = [
            "Aircraft serial",
            "Part number",
            "Description",
            "Failure 5 hours",
        ]
        self.assertEqual(rows[0], expected_header)

        # Check that there are no data rows
        self.assertEqual(len(rows), 1)
